# VSCode ä¸­ Gemini CLI ä¸€æ­¥ä¸€æ­¥è°ƒè¯•æŒ‡å—

> **é€‚ç”¨é¡¹ç›®**: Gemini CLI **æ›´æ–°æ—¶é—´**: 2025-11-15 **è°ƒè¯•ç¯å¢ƒ**: VSCode +
> Node.js è°ƒè¯•å™¨

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### 1. æ‰“å¼€è°ƒè¯•é¢æ¿

- æŒ‰ `Ctrl+Shift+D` (Windows/Linux) æˆ– `Cmd+Shift+D` (Mac)
- æˆ–ç‚¹å‡»å·¦ä¾§æ´»åŠ¨æ çš„è°ƒè¯•å›¾æ ‡ ğŸ›

### 2. é€‰æ‹©è°ƒè¯•é…ç½®

åœ¨è°ƒè¯•é¢æ¿é¡¶éƒ¨çš„ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©ä»¥ä¸‹ä»»ä¸€é…ç½®ï¼š

- **Debug CLI from Start** - æ¨èï¼šä»å¯åŠ¨è„šæœ¬å¼€å§‹è°ƒè¯•
- **Debug CLI with Args** - è°ƒè¯•å¸¦å‚æ•°çš„ CLI
- **Build & Launch CLI** - æ„å»ºåå¯åŠ¨è°ƒè¯•

### 3. å¼€å§‹è°ƒè¯•

- æŒ‰ `F5` æˆ–ç‚¹å‡»ç»¿è‰²æ’­æ”¾æŒ‰é’® â–¶ï¸

## ğŸ“‹ å¯ç”¨çš„è°ƒè¯•é…ç½®

### ğŸ”¥ ä¸»è¦è°ƒè¯•é…ç½®

#### 1. **Debug CLI from Start** (æ¨è)

```json
{
  "name": "Debug CLI from Start",
  "type": "node",
  "request": "launch",
  "runtimeExecutable": "npm",
  "runtimeArgs": ["run", "debug"]
}
```

**ç‰¹ç‚¹**:

- âœ… ä½¿ç”¨ `--inspect-brk` åœ¨ç¬¬ä¸€è¡Œæš‚åœ
- âœ… å¯ç”¨è°ƒè¯•æ—¥å¿— (`DEBUG=1`)
- âœ… è‡ªåŠ¨æ„å»ºé¡¹ç›®
- âœ… æœ€é€‚åˆè°ƒè¯•å¯åŠ¨æµç¨‹

**ä½¿ç”¨åœºæ™¯**: è°ƒè¯• CLI å¯åŠ¨ã€é…ç½®åŠ è½½ã€åˆå§‹åŒ–é€»è¾‘

#### 2. **Debug CLI with Args**

```json
{
  "name": "Debug CLI with Args",
  "program": "${workspaceFolder}/scripts/start.js",
  "args": ["--help"]
}
```

**ç‰¹ç‚¹**:

- âœ… å¯ä»¥è‡ªå®šä¹‰å‘½ä»¤è¡Œå‚æ•°
- âœ… ç›´æ¥æ‰§è¡Œ start.js
- âœ… é€‚åˆæµ‹è¯•ç‰¹å®šå‘½ä»¤

**ä½¿ç”¨åœºæ™¯**: è°ƒè¯•ç‰¹å®šçš„ CLI å‘½ä»¤å’Œå‚æ•°å¤„ç†

#### 3. **Build & Launch CLI**

```json
{
  "name": "Build & Launch CLI",
  "runtimeExecutable": "npm",
  "runtimeArgs": ["run", "build-and-start"]
}
```

**ç‰¹ç‚¹**:

- âœ… å®Œæ•´çš„æ„å»º + å¯åŠ¨æµç¨‹
- âœ… æ¨¡æ‹Ÿç”Ÿäº§ç¯å¢ƒä½¿ç”¨
- âœ… ç¡®ä¿ä»£ç æ˜¯æœ€æ–°æ„å»ºçš„

**ä½¿ç”¨åœºæ™¯**: è°ƒè¯•æ„å»ºåçš„å®Œæ•´æµç¨‹

### ğŸ”§ è¾…åŠ©è°ƒè¯•é…ç½®

#### 4. **Attach** (é™„åŠ è°ƒè¯•)

```json
{
  "name": "Attach",
  "type": "node",
  "request": "attach",
  "port": 9229
}
```

**ä½¿ç”¨æ–¹æ³•**:

1. å…ˆæ‰‹åŠ¨å¯åŠ¨è°ƒè¯•è¿›ç¨‹ï¼š
   ```bash
   npm run debug
   ```
2. ç„¶åé€‰æ‹© "Attach" é…ç½®å¹¶æŒ‰ F5

#### 5. **Launch Program** (å•æ–‡ä»¶è°ƒè¯•)

é€‚åˆè°ƒè¯•å•ä¸ªæ–‡ä»¶æˆ–è„šæœ¬

#### 6. **Debug Test File** (æµ‹è¯•è°ƒè¯•)

ä¸“é—¨ç”¨äºè°ƒè¯•å•å…ƒæµ‹è¯•æ–‡ä»¶

## ğŸ› ä¸€æ­¥ä¸€æ­¥è°ƒè¯•æ“ä½œ

### æ­¥éª¤ 1: è®¾ç½®æ–­ç‚¹

```typescript
// åœ¨è¦è°ƒè¯•çš„ä»£ç è¡Œå·¦ä¾§ç‚¹å‡»ï¼Œå‡ºç°çº¢è‰²åœ†ç‚¹
console.log('è¿™é‡Œä¼šæš‚åœ'); // â† åœ¨è¿™è¡Œè®¾ç½®æ–­ç‚¹
```

**è®¾ç½®æ–­ç‚¹çš„æ–¹æ³•**:

- **æ™®é€šæ–­ç‚¹**: ç‚¹å‡»è¡Œå·å·¦ä¾§
- **æ¡ä»¶æ–­ç‚¹**: å³é”® â†’ "æ·»åŠ æ¡ä»¶æ–­ç‚¹"
- **æ—¥å¿—æ–­ç‚¹**: å³é”® â†’ "æ·»åŠ æ—¥å¿—ç‚¹"

### æ­¥éª¤ 2: å¯åŠ¨è°ƒè¯•

1. é€‰æ‹© **"Debug CLI from Start"** é…ç½®
2. æŒ‰ `F5` å¯åŠ¨è°ƒè¯•
3. ç¨‹åºä¼šåœ¨ç¬¬ä¸€è¡Œä»£ç å¤„æš‚åœ

### æ­¥éª¤ 3: è°ƒè¯•æ§åˆ¶

ä½¿ç”¨è°ƒè¯•å·¥å…·æ æˆ–å¿«æ·é”®æ§åˆ¶æ‰§è¡Œï¼š

| æ“ä½œ         | å¿«æ·é”®          | å›¾æ ‡ | è¯´æ˜                       |
| ------------ | --------------- | ---- | -------------------------- |
| **ç»§ç»­**     | `F5`            | â–¶ï¸   | ç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹       |
| **å•æ­¥è·³è¿‡** | `F10`           | â¤´ï¸   | æ‰§è¡Œå½“å‰è¡Œï¼Œä¸è¿›å…¥å‡½æ•°å†…éƒ¨ |
| **å•æ­¥è·³å…¥** | `F11`           | â¤µï¸   | è¿›å…¥å‡½æ•°å†…éƒ¨è°ƒè¯•           |
| **å•æ­¥è·³å‡º** | `Shift+F11`     | â¤´ï¸   | è·³å‡ºå½“å‰å‡½æ•°               |
| **é‡å¯**     | `Ctrl+Shift+F5` | ğŸ”„   | é‡æ–°å¼€å§‹è°ƒè¯•               |
| **åœæ­¢**     | `Shift+F5`      | â¹ï¸   | åœæ­¢è°ƒè¯•                   |

### æ­¥éª¤ 4: æŸ¥çœ‹å˜é‡å’ŒçŠ¶æ€

#### ğŸ” å˜é‡çª—å£ (Variables)

- æŸ¥çœ‹å½“å‰ä½œç”¨åŸŸä¸­çš„æ‰€æœ‰å˜é‡
- å¯ä»¥å±•å¼€å¯¹è±¡å’Œæ•°ç»„
- å¯ä»¥ä¿®æ”¹å˜é‡å€¼è¿›è¡Œæµ‹è¯•

#### ğŸ“º ç›‘è§†çª—å£ (Watch)

```javascript
// æ·»åŠ åˆ°ç›‘è§†çª—å£çš„è¡¨è¾¾å¼ç¤ºä¾‹
config.api.key; // ç›‘è§†é…ç½®å¯¹è±¡
user.permissions; // ç›‘è§†ç”¨æˆ·æƒé™
process.env.DEBUG; // ç›‘è§†ç¯å¢ƒå˜é‡
```

#### ğŸ“ è°ƒç”¨å †æ ˆ (Call Stack)

- æ˜¾ç¤ºå½“å‰æ‰§è¡Œçš„å‡½æ•°è°ƒç”¨é“¾
- ç‚¹å‡»ä¸åŒçš„å †æ ˆå¸§æŸ¥çœ‹ä¸Šä¸‹æ–‡
- äº†è§£ä»£ç æ‰§è¡Œè·¯å¾„

### æ­¥éª¤ 5: è°ƒè¯•æ§åˆ¶å°

æŒ‰ `Ctrl+Shift+Y` æ‰“å¼€è°ƒè¯•æ§åˆ¶å°ï¼Œå¯ä»¥ï¼š

```javascript
// åœ¨è°ƒè¯•æ§åˆ¶å°ä¸­æ‰§è¡Œä»£ç 
console.log(config); // æ‰“å°å˜é‡
config.debug = true; // ä¿®æ”¹å˜é‡
typeof user; // æ£€æŸ¥ç±»å‹
Object.keys(options); // æŸ¥çœ‹å¯¹è±¡å±æ€§
```

## ğŸ¯ å¸¸è§è°ƒè¯•åœºæ™¯

### åœºæ™¯ 1: è°ƒè¯• CLI å¯åŠ¨æµç¨‹

```typescript
// åœ¨ scripts/start.js ä¸­è®¾ç½®æ–­ç‚¹
import { spawn, execSync } from 'node:child_process';

// è®¾ç½®æ–­ç‚¹ â† è¿™é‡Œ
const buildProcess = spawn('npm', ['run', 'build']);
```

**æ“ä½œæ­¥éª¤**:

1. åœ¨ `scripts/start.js` ç¬¬ä¸€è¡Œè®¾ç½®æ–­ç‚¹
2. é€‰æ‹© "Debug CLI from Start"
3. æŒ‰ F5ï¼Œç¨‹åºä¼šåœ¨æ–­ç‚¹å¤„æš‚åœ
4. ä½¿ç”¨ F10 å•æ­¥æ‰§è¡Œï¼Œè§‚å¯Ÿå¯åŠ¨è¿‡ç¨‹

### åœºæ™¯ 2: è°ƒè¯•ç‰¹å®šå‘½ä»¤

**è°ƒè¯• `gemini --help` å‘½ä»¤**:

1. ä¿®æ”¹ "Debug CLI with Args" é…ç½®çš„ args:
   ```json
   "args": ["--help"]
   ```
2. åœ¨å‘½ä»¤å¤„ç†é€»è¾‘ä¸­è®¾ç½®æ–­ç‚¹
3. å¯åŠ¨è°ƒè¯•ï¼Œè§‚å¯Ÿå‚æ•°è§£æè¿‡ç¨‹

### åœºæ™¯ 3: è°ƒè¯•é…ç½®åŠ è½½

```typescript
// åœ¨é…ç½®åŠ è½½ç›¸å…³æ–‡ä»¶ä¸­è®¾ç½®æ–­ç‚¹
// packages/core/src/config/config-loader.ts
export function loadConfig() {
  // è®¾ç½®æ–­ç‚¹ â† è¿™é‡Œ
  const configPath = findConfigFile();
  return parseConfig(configPath);
}
```

### åœºæ™¯ 4: è°ƒè¯• MCP å®¢æˆ·ç«¯

```typescript
// åœ¨ MCP ç›¸å…³æ–‡ä»¶ä¸­è°ƒè¯•
// packages/core/src/tools/mcp-client-manager.ts
export class MCPClientManager {
  async initializeClient() {
    // è®¾ç½®æ–­ç‚¹ â† è¿™é‡Œ
    const client = new MCPClient();
  }
}
```

## ğŸš€ é«˜çº§è°ƒè¯•æŠ€å·§

### 1. æ¡ä»¶æ–­ç‚¹

```typescript
// åªåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æš‚åœ
// å³é”®æ–­ç‚¹ â†’ "ç¼–è¾‘æ–­ç‚¹" â†’ æ·»åŠ æ¡ä»¶
user.id === 'admin'; // åªåœ¨ç®¡ç†å‘˜ç”¨æˆ·æ—¶æš‚åœ
count > 10; // åªåœ¨è®¡æ•°å¤§äº10æ—¶æš‚åœ
config.debug === true; // åªåœ¨è°ƒè¯•æ¨¡å¼æ—¶æš‚åœ
```

### 2. æ—¥å¿—æ–­ç‚¹

```typescript
// åœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹æ·»åŠ æ—¥å¿—
// å³é”® â†’ "æ·»åŠ æ—¥å¿—ç‚¹"
// è¾“å…¥: å½“å‰ç”¨æˆ·: {user.name}, é…ç½®: {config.mode}
```

### 3. å¼‚å¸¸æ–­ç‚¹

åœ¨è°ƒè¯•é¢æ¿ä¸­å¯ç”¨"åœ¨å¼‚å¸¸å¤„æš‚åœ"ï¼š

- âœ… æ•è·çš„å¼‚å¸¸ - åœ¨ try/catch ä¸­æš‚åœ
- âœ… æœªæ•è·çš„å¼‚å¸¸ - åœ¨ç¨‹åºå´©æºƒå‰æš‚åœ

### 4. æºæ˜ å°„è°ƒè¯•

é¡¹ç›®ä½¿ç”¨ TypeScriptï¼ŒVSCode ä¼šè‡ªåŠ¨ï¼š

- ğŸ“ æ˜¾ç¤º TypeScript æºç è€Œä¸æ˜¯ç¼–è¯‘åçš„ JavaScript
- ğŸ¯ åœ¨ `.ts` æ–‡ä»¶ä¸­è®¾ç½®æ–­ç‚¹
- ğŸ”„ å®æ—¶æ˜ å°„å˜é‡åå’Œè¡Œå·

## ğŸ› ï¸ è°ƒè¯•ç¯å¢ƒé…ç½®

### å¿…éœ€çš„ VSCode æ‰©å±•

```json
// .vscode/extensions.json (é¡¹ç›®å·²åŒ…å«)
{
  "recommendations": [
    "ms-vscode.vscode-typescript-next", // TypeScript æ”¯æŒ
    "ms-vscode.js-debug", // JavaScript è°ƒè¯•å™¨
    "bradlc.vscode-tailwindcss" // å¦‚æœä½¿ç”¨ Tailwind
  ]
}
```

### å…³é”®è®¾ç½®

```json
// .vscode/settings.json
{
  "debug.allowBreakpointsEverywhere": true,
  "debug.inlineValues": true,
  "typescript.preferences.includePackageJsonAutoImports": "auto"
}
```

## â— å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜ 1: æ–­ç‚¹æ— æ•ˆï¼ˆç°è‰²ï¼‰

**åŸå› **: æºæ˜ å°„é—®é¢˜æˆ–ä»£ç æœªæ„å»º **è§£å†³**:

```bash
# é‡æ–°æ„å»ºé¡¹ç›®
npm run build
# é‡å¯è°ƒè¯•ä¼šè¯
```

### é—®é¢˜ 2: æ— æ³•è¿æ¥åˆ°è°ƒè¯•å™¨

**åŸå› **: ç«¯å£å†²çªæˆ–è¿›ç¨‹å·²è¿è¡Œ **è§£å†³**:

```bash
# æ€æ­»ç°æœ‰çš„ Node.js è¿›ç¨‹
pkill -f "node.*inspect"
# æˆ–æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :9229
```

### é—®é¢˜ 3: å˜é‡æ˜¾ç¤º `<unavailable>`

**åŸå› **: ä»£ç ä¼˜åŒ–æˆ–ä½œç”¨åŸŸé—®é¢˜ **è§£å†³**: åœ¨ launch.json ä¸­æ·»åŠ ï¼š

```json
{
  "runtimeArgs": ["--inspect-brk", "--no-optimize"]
}
```

### é—®é¢˜ 4: TypeScript æ–­ç‚¹ä¸å‡†ç¡®

**åŸå› **: æºæ˜ å°„é…ç½®é—®é¢˜ **è§£å†³**: æ£€æŸ¥ tsconfig.jsonï¼š

```json
{
  "compilerOptions": {
    "sourceMap": true,
    "inlineSourceMap": false
  }
}
```

## ğŸ“š è°ƒè¯•æœ€ä½³å®è·µ

### 1. æœ‰é’ˆå¯¹æ€§çš„æ–­ç‚¹

```typescript
// âœ… å¥½çš„æ–­ç‚¹ä½ç½®
if (config.debug) {
  // è®¾ç½®æ–­ç‚¹è¿™é‡Œï¼Œåªåœ¨è°ƒè¯•æ¨¡å¼è§¦å‘
  console.log('Debug mode enabled');
}

// âŒ é¿å…åœ¨é«˜é¢‘å¾ªç¯ä¸­è®¾ç½®æ–­ç‚¹
for (let i = 0; i < 10000; i++) {
  // ä¸è¦åœ¨è¿™é‡Œè®¾ç½®æ–­ç‚¹
}
```

### 2. åˆ©ç”¨è°ƒè¯•æ§åˆ¶å°

```javascript
// åœ¨è°ƒè¯•æ§åˆ¶å°ä¸­å¿«é€Ÿæµ‹è¯•
JSON.stringify(config, null, 2); // æ ¼å¼åŒ–è¾“å‡ºå¯¹è±¡
config.api?.endpoint; // å®‰å…¨è®¿é—®å±æ€§
Object.getOwnPropertyNames(obj); // æŸ¥çœ‹æ‰€æœ‰å±æ€§
```

### 3. ç›‘è§†å…³é”®è¡¨è¾¾å¼

```javascript
// æ·»åŠ åˆ°ç›‘è§†çª—å£
process.env.NODE_ENV; // å½“å‰ç¯å¢ƒ
config?.logging?.level; // æ—¥å¿—çº§åˆ«
user?.permissions?.admin; // ç”¨æˆ·æƒé™
error?.stack?.split('\n')[0]; // é”™è¯¯ä¿¡æ¯
```

### 4. ä½¿ç”¨è°ƒç”¨å †æ ˆå¯¼èˆª

- ğŸ‘† å‘ä¸ŠæŸ¥çœ‹è°ƒç”¨æ¥æº
- ğŸ‘‡ å‘ä¸‹æŸ¥çœ‹å…·ä½“å®ç°
- ğŸ¯ å¿«é€Ÿå®šä½é—®é¢˜æ ¹æº

## ğŸ”„ è°ƒè¯•å·¥ä½œæµç¨‹å»ºè®®

### æ—¥å¸¸å¼€å‘è°ƒè¯•

1. **è®¾ç½®æ–­ç‚¹** â†’ é€‰æ‹©è°ƒè¯•é…ç½® â†’ **F5 å¯åŠ¨**
2. **F10 å•æ­¥æ‰§è¡Œ** â†’ è§‚å¯Ÿå˜é‡å˜åŒ–
3. **è°ƒè¯•æ§åˆ¶å°éªŒè¯** â†’ ä¿®æ”¹æµ‹è¯•
4. **ç»§ç»­æˆ–é‡å¯** â†’ éªŒè¯ä¿®å¤

### é—®é¢˜æ’æŸ¥è°ƒè¯•

1. **å¤ç°é—®é¢˜** â†’ åœ¨ç›¸å…³ä»£ç è®¾ç½®æ–­ç‚¹
2. **æ¡ä»¶æ–­ç‚¹** â†’ åªåœ¨é—®é¢˜æ¡ä»¶ä¸‹æš‚åœ
3. **è°ƒç”¨å †æ ˆåˆ†æ** â†’ æ‰¾å‡ºé—®é¢˜æ¥æº
4. **ç›‘è§†å…³é”®å˜é‡** â†’ è§‚å¯ŸçŠ¶æ€å˜åŒ–

### æ€§èƒ½è°ƒè¯•

1. **æ—¶é—´æµ‹é‡**:
   ```typescript
   console.time('operation');
   // æ‰§è¡Œä»£ç 
   console.timeEnd('operation');
   ```
2. **å†…å­˜ç›‘æ§**: åœ¨è°ƒè¯•é¢æ¿æŸ¥çœ‹å†…å­˜ä½¿ç”¨
3. **å¼‚æ­¥è°ƒè¯•**: è®¾ç½® Promise å’Œ async/await æ–­ç‚¹

---

## ğŸ‰ æ€»ç»“

é€šè¿‡ä»¥ä¸Šé…ç½®å’ŒæŠ€å·§ï¼Œä½ å¯ä»¥åœ¨ VSCode ä¸­é«˜æ•ˆåœ°è°ƒè¯• Gemini CLI é¡¹ç›®ï¼š

- âœ… **å¤šç§è°ƒè¯•é…ç½®**æ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚
- âœ… **ä¸€æ­¥ä¸€æ­¥è°ƒè¯•**å¸®åŠ©ç†è§£ä»£ç æ‰§è¡Œæµç¨‹
- âœ… **ä¸°å¯Œçš„è°ƒè¯•å·¥å…·**æä¾›å…¨é¢çš„ä»£ç æ´å¯Ÿ
- âœ… **æœ€ä½³å®è·µæŒ‡å¯¼**æé«˜è°ƒè¯•æ•ˆç‡

**å¿«é€Ÿå¼€å§‹**: é€‰æ‹© "Debug CLI from Start" â†’ æŒ‰ F5 â†’ å¼€å§‹ä½ çš„è°ƒè¯•ä¹‹æ—…ï¼ ğŸš€

---

_æœ¬æŒ‡å—åŸºäº Gemini CLI é¡¹ç›®çš„å®é™…é…ç½®ç¼–å†™ï¼Œé€‚ç”¨äº VSCode 1.80+ ç‰ˆæœ¬ã€‚_
