# 贡献指南

<cite>
**本文档中引用的文件**  
- [CONTRIBUTING.md](file://CONTRIBUTING.md)
- [package.json](file://package.json)
- [README.md](file://README.md)
- [tsconfig.json](file://tsconfig.json)
- [integration-tests/vitest.config.ts](file://integration-tests/vitest.config.ts)
- [packages/cli/package.json](file://packages/cli/package.json)
- [packages/core/package.json](file://packages/core/package.json)
- [packages/core/src/index.ts](file://packages/core/src/index.ts)
- [packages/cli/vitest.config.ts](file://packages/cli/vitest.config.ts)
- [packages/core/vitest.config.ts](file://packages/core/vitest.config.ts)
- [eslint.config.js](file://eslint.config.js)
- [scripts/build.js](file://scripts/build.js)
</cite>

## 目录

1. [简介](#简介)
2. [开发环境设置](#开发环境设置)
3. [代码库结构](#代码库结构)
4. [技术栈](#技术栈)
5. [编码规范](#编码规范)
6. [测试](#测试)
7. [拉取请求最佳实践](#拉取请求最佳实践)
8. [贡献类型](#贡献类型)

## 简介

欢迎为 Gemini
CLI 项目做贡献！本指南旨在帮助社区成员了解如何为项目做出贡献。Gemini
CLI 是一个开源的 AI 代理，将 Gemini 的强大功能直接带入终端。我们鼓励社区成员贡献代码、文档和报告问题。

**Section sources**

- [CONTRIBUTING.md](file://CONTRIBUTING.md#L1-L549)
- [README.md](file://README.md#L1-L375)

## 开发环境设置

### 先决条件

在开始开发之前，请确保您的系统满足以下先决条件：

- **Node.js**: 开发环境需要 Node.js `~20.19.0` 版本。建议使用
  [nvm](https://github.com/nvm-sh/nvm) 来管理 Node.js 版本。生产环境需要 Node.js
  `>=20`。
- **Git**: 用于版本控制。

### 克隆仓库

```bash
git clone https://github.com/google-gemini/gemini-cli.git
cd gemini-cli
```

### 安装依赖

```bash
npm install
```

### 构建项目

要构建整个项目（所有包）：

```bash
npm run build
```

要构建 CLI 工具和沙箱容器：

```bash
npm run build:all
```

### 运行 CLI

从源代码启动 Gemini CLI：

```bash
npm start
```

**Section sources**

- [CONTRIBUTING.md](file://CONTRIBUTING.md#L161-L233)
- [package.json](file://package.json#L20-L22)

## 代码库结构

项目采用多包（monorepo）结构，主要目录如下：

- `packages/`: 包含项目的各个子包
  - `a2a-server`: Gemini CLI 的 A2A 服务器实现（实验性）
  - `cli/`: 命令行界面
  - `core/`: Gemini CLI 的核心后端逻辑
  - `test-utils`: 用于创建和清理临时文件系统的测试工具
  - `vscode-ide-companion/`: Gemini CLI Companion 扩展与 Gemini CLI 配合使用
- `docs/`: 包含所有项目文档
- `integration-tests/`: 集成测试
- `scripts/`: 用于构建、测试和开发任务的实用脚本
- `schemas/`: 配置模式定义
- `third_party/`: 第三方依赖

**Section sources**

- [CONTRIBUTING.md](file://CONTRIBUTING.md#L322-L335)

## 技术栈

Gemini CLI 使用以下技术栈：

- **TypeScript**: 主要编程语言，提供类型安全和更好的开发体验
- **React**: 用于构建 CLI 的用户界面
- **Ink**: 用于在终端中渲染 React 组件的库
- **Node.js**: 运行时环境
- **Vitest**: 测试框架
- **ESLint**: 代码检查
- **Prettier**: 代码格式化

**Section sources**

- [packages/cli/package.json](file://packages/cli/package.json#L53-L54)
- [packages/core/package.json](file://packages/core/package.json#L40-L41)

## 编码规范

### 代码风格

请遵循现有代码库中的编码风格、模式和约定。项目使用 ESLint 和 Prettier 来确保代码质量和格式一致性。

### 导入路径

特别注意导入路径。项目使用 ESLint 强制限制包之间的相对导入。

### 提交消息格式

遵循 [Conventional Commits](https://www.conventionalcommits.org/)
标准编写提交消息。

**Section sources**

- [CONTRIBUTING.md](file://CONTRIBUTING.md#L310-L321)

## 测试

### 单元测试

运行单元测试套件：

```bash
npm run test
```

这将运行 `packages/core` 和 `packages/cli` 目录中的测试。

### 集成测试

运行集成测试：

```bash
npm run test:e2e
```

集成测试验证 Gemini CLI 的端到端功能。

### 预检检查

在提交更改之前，确保所有检查通过：

```bash
npm run preflight
```

此命令将运行 ESLint、Prettier、所有测试和其他检查。

**Section sources**

- [CONTRIBUTING.md](file://CONTRIBUTING.md#L234-L273)
- [integration-tests/vitest.config.ts](file://integration-tests/vitest.config.ts#L1-L25)
- [packages/cli/vitest.config.ts](file://packages/cli/vitest.config.ts#L1-L59)
- [packages/core/vitest.config.ts](file://packages/core/vitest.config.ts#L1-L40)

## 拉取请求最佳实践

### 分支策略

1. Fork 仓库并创建新分支
2. 在 `packages/` 目录中进行更改
3. 确保所有检查通过

### 提交消息和 PR 描述

- PR 应有清晰、描述性的标题
- 在 PR 描述中解释更改的"为什么"，并链接到相关问题
- 遵循 Conventional Commits 标准

### 代码审查流程

所有提交都需要审查。我们使用 GitHub pull
requests 进行此目的。如果您的拉取请求涉及
`packages/cli`（前端）的更改，建议运行自动化前端审查工具。

**Section sources**

- [CONTRIBUTING.md](file://CONTRIBUTING.md#L84-L147)

## 贡献类型

我们欢迎以下类型的贡献：

- **代码贡献**: 修复 bug、添加新功能、改进性能
- **文档贡献**: 改进现有文档、添加新文档、修复错误
- **问题报告**: 报告 bug、提出功能请求
- **扩展和 MCP 服务器**: 分享您的 MCP 服务器和扩展

**Section sources**

- [CONTRIBUTING.md](file://CONTRIBUTING.md#L333-L342)
